<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://site.sewenthy.dev/feed.xml" rel="self" type="application/atom+xml"/><link href="https://site.sewenthy.dev/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-08-10T06:29:18+00:00</updated><id>https://site.sewenthy.dev/feed.xml</id><title type="html">Sewen Thy</title><subtitle>My personal site. </subtitle><entry><title type="html">Urban Gardening with Automation</title><link href="https://site.sewenthy.dev/blog/2024/1_gardening_starting/" rel="alternate" type="text/html" title="Urban Gardening with Automation"/><published>2024-06-16T00:00:00+00:00</published><updated>2024-06-16T00:00:00+00:00</updated><id>https://site.sewenthy.dev/blog/2024/1_gardening_starting</id><content type="html" xml:base="https://site.sewenthy.dev/blog/2024/1_gardening_starting/"><![CDATA[<p>Since graduating in 2023, one of the biggest things I missed about Yale-NUS was the green campus. Everywhere I look there’d always be some piece of green. My suitemates were even more into plants than me, so when I walked into their rooms, there were always some potted plants and long leafy vines growing from the top of their bookcases. But I was never a fan of dirt spilling from the plants onto my floor and more importantly, I never felt responsible enough to take care of them, so I never had any while I was at school.</p> <p>Since I moved out I have been playing around with home automation using <a href="https://www.home-assistant.io/">Home Assistant (HA)</a> using the <a href="https://www.home-assistant.io/integrations/zha/">Zigbee Home Automation (ZHA)</a>. I realized that while I still may forget to water my plants, I can get my garden to water itself–and I can make cool graphs with my sensor data.</p> <h1 id="picking-the-plants">Picking the plants</h1> <p>I have been trying to have a more vegetarian diet so I wanted to priorities my favorites such as <a href="https://gardeningsg.nparks.gov.sg/page-index/edible-plants/brinjal/">eggplants (brinjal)</a>, <a href="https://gardeningsg.nparks.gov.sg/page-index/edible-plants/tomato/">tomatoes</a> and <a href="https://gardeningsg.nparks.gov.sg/page-index/edible-plants/winged-bean/">winged beans</a>. After some quick googling, I found that the Singapore government encourages all these gardening efforts and even has amazing resources on how to get them growing.</p> <p>However, as I read through I realized I forgot about one important thing: bees. Aside from winged beans most of the veggies I like need pollination and so need some kind of pollinators. As I live on the 20th floors, I wasn’t sure if they would come all the way up. I needed something to check first so I decided to start small: <a href="https://gardeningsg.nparks.gov.sg/page-index/edible-plants/butterfly-pea/">butterfly peas</a>. These are even <a href="https://gardeningsg.nparks.gov.sg/page-index/edible-plants/butterfly-pea/">considered weeds</a> in some cases because they grow so easily so I’m making my life easier and they have the added benefit of being a bees-attractor.</p> <h1 id="getting-supplies-and-starting-the-seedlings">Getting supplies and starting the seedlings</h1> <p>After consulting more internet resources, I found out I needed the following:</p> <ul> <li>some loamy soils*</li> <li>pots of at least 20cm deep*</li> <li>trellis (for the vines to climb)</li> <li>seedlings tray</li> <li>seeds</li> </ul> <p>*as advised by <a href="https://gardeningsg.nparks.gov.sg/page-index/edible-plants/butterfly-pea/">NParks</a>.</p> <p>I got the seedling tray that has some holes in the bottom since I’m completely new at this so I might overwater the seedlings and I also the lid to protect it while it’s sitting on my balcony.</p> <p>I got the soil and seed, from a local seller for a combined of ~SGD5 and the rest I got off of AliExpress which totals to ~SGD10.</p> <p>I only just started to sow the seeds yesterday and we will see the result soon!</p> <div class="l-body"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/seedling_tray_starting-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/seedling_tray_starting-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/seedling_tray_starting-1400.webp"/> <img src="/assets/img/seedling_tray_starting.jpeg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <h1 id="minor-automation">Minor automation</h1> <p>For now, the only sensor data I have is from 1 moisture sensor level using Zigbee (~SGD20). I had some issues with setting it up with HA as it is ZHA does not fully understand how to interpret the data coming from the model, <code class="language-plaintext highlighter-rouge">_TZE204_myd45weu</code>. Following the guide from the HA community <a href="https://community.home-assistant.io/t/ts0601-tze200-ga1maeof-soil-moisture-sensor-and-zha/590913">here</a>, I found out how to get ZHA to understand it with a custom “quirk” modified from this <a href="https://github.com/zigpy/zha-device-handlers/blob/92c9fbc6d01a5d86f78d64183302b906aa7d8215/zhaquirks/tuya/ts0601_sensor.py">original handler</a>.</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-         MODELS_INFO: [("_TZE200_myd45weu", "TS0601")],
</span><span class="gi">+         MODELS_INFO: [("_TZE204_myd45weu", "TS0601")],
</span></code></pre></div></div> <p>After this fix and <a href="https://community.home-assistant.io/t/how-to-setup-local-zha-quirks/341226/2?u=sewenthy">enabling HA to use the quirks</a>, I managed to get the sensor moisture and temperature readings.</p> <p>I recorded the before and after watering moisture and temperature of the seedling tray, and I thought it was quite cool even though it’s quite a simple graph currently.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/soil_moist_temp_graph-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/soil_moist_temp_graph-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/soil_moist_temp_graph-1400.webp"/> <img src="/assets/img/soil_moist_temp_graph.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/seedling_tray_moisture_sensor-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/seedling_tray_moisture_sensor-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/seedling_tray_moisture_sensor-1400.webp"/> <img src="/assets/img/seedling_tray_moisture_sensor.jpeg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h1 id="plans-for-more-automation">Plans for more automation</h1> <h2 id="bees-checker">Bees Checker</h2> <p>One thing I want to get going is running a small computer vision model to check if the garden is receiving any pollinators–i.e. whether my butterfly pea plan works or not. This will help me decide on what kind of plants I can do after. Of course, I can just wait and chance upon some bees pollinating the garden but that wouldn’t be as fun as struggling for hours to get a model to process many images taken by a SGD25 IP camera and see if it can find the bees.</p> <p>My current plan is to find some light model off of <a href="https://huggingface.co/">huggingface</a>, ideally, something I can run locally with a small overworked GPU.</p> <h2 id="mysensors--drip-irrigations">MySensors &amp; Drip Irrigations</h2> <p>Since the moisture sensor I got was quite expensive for 1 sensor, I would want to expand my garden afterward with multiple pots, and sensors (much more data points for cool graphs) as well as having some kind of drip irrigation working off of that data. I need a more cost-effective method to get some readings. I found some capacitive sensors on Aliexpress for &lt;SGD1 each and it works with <a href="https://www.arduino.cc/">Arduino</a>. Great! It’s also a good thing I got the current Zigbee sensor because it is quite trusted, and well-tuned. I can fine-tune the data of the Arduino output to be similar to the current sensor.</p> <p>Having all that data is well-and-good but I also need to have it connect to HA somehow (otherwise, no cool graphs). This is when I chance upon <a href="https://www.mysensors.org/about/iot">MySensors</a> which will also supposedly work with HA.</p> <p>I got some equipment from AliExpress again:</p> <ul> <li>Zigbee soil moisture and temperature sensor</li> <li>Zigbee water pump</li> <li>drip irrigation pipes</li> <li>Nodemcu V2 ESP8266 (recommended by MySensors)</li> <li>Arduino UNO R3 with the starter kit</li> <li>5 pcs of capacitive soil moisture sensor</li> <li>jumper wires and breadboards</li> </ul> <p>This all went for ~SGD90 (ah, the price I pay for graphs).</p> <p>So this is my plan for the next few weeks–getting Arduino to read moisture sensors and pass it to my HA server. If all goes well then I’ll try making HA run the smart pump based on all the moisture sensors data. This will be slightly tricky as my balcony sadly do not have any water outlet. My plan is to use some kind of bucket (possibly with rain catchment into the bucket too), drill a hole at the bottom and use the pressure to run the pump.</p> <h3 id="ocaml-for-arduino">OCaml for Arduino?</h3> <p>I love OCaml so the obvious next steps is to maybe have the code I write to integrate these sensors and HA in OCaml. Although it looks like there’s not many widely used projects–I found a few that I made a fork of namely: <a href="https://github.com/sewenthy/OMicroB">OMicroB</a> and <a href="https://github.com/sewenthy/firmata">firmata</a>. I have not done much other than trying to get it to compile, but it’s on the back of my mind.</p>]]></content><author><name></name></author><category term="gardening"/><category term="home-automation"/><category term="zigbee"/><category term="gardening"/><category term="urban"/><category term="home-assistant"/><category term="home-automation"/><category term="zha"/><category term="butterfly-pea"/><category term="bee"/><summary type="html"><![CDATA[Initial work for the garden and some planning for future automation]]></summary></entry></feed>